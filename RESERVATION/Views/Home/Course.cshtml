@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860

*@
@{
    ViewData["Title"] = "Course";
}
@model IEnumerable<RESERVATION.Models.T_COURSE>



<div id="calendar">
    <div class="back">
        
            <div class="option">
            <div>
                <h4 class="title2">人数</h4>
                <p class="red-text">*回答必須</p>
            </div>
        @foreach (var item in Model)
        {
               
//                <input type="hidden" asp-for="courceId" />
                <div  class="form-check" asp-action="Course">
                <input class="form-check-input" type="radio"
                       value="5500"
                           name="flexRadioDefault" id="flexRadioDefault{$ @Html.DisplayFor(modelItem => item.courceId)}"
                       >
                    <label class="form-check-label" for="flexRadioDefault{$ @Html.DisplayFor(modelItem => item.courceId)}">
                        @Html.DisplayFor(modelItem => item.courceName) <span> @Html.DisplayFor(modelItem => item.price) (税込)</span>
                </label>
            </div>
        }
        </div>
        <div class="option">
            <div>
                <h4 class="title2">オプション サウナ飯</h4>
                <p class="red-text">*回答必須</p>
            </div>

            <div class="form-check">
                <input class="form-check-input" type="checkbox"
                       value="3300"
                       id="flexCheckDefault1">
                <label class="form-check-label" for="flexCheckDefault1">
                    d <span>¥ 23 (税込)</span>
                </label> 
            </div>

            
        </div>
        <div id="payment">
            <div id="total">
                <div>

                    <p>確定時のお支払い合計</p>
                </div>
                <div>

                    <span>¥</span><span id="result">5,500</span><span>(税込)</span>
                </div>

            </div>
            <div>
                <button class="btn btn-primary" id="pay"
                        type="submit">
                    枠料金
                </button>
            </div>
        </div>
    </div>
</div>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
<script>
    $(document).ready(function () {
        $('input[type="radio"]').change(function () {
            calculateSum();
        });

        $('input[type="checkbox"]').change(function () {
            calculateSum();
        });

        function calculateSum() {
            var radioSum = 0;
            var checkboxSum = 0;

            $('input[type="radio"]:checked').each(function () {
                radioSum += parseInt($(this).val());
            });

            $('input[type="checkbox"]:checked').each(function () {
                checkboxSum += parseInt($(this).val());
            });

            var totalSum = radioSum + checkboxSum;
            if (totalSum >= 1000) $('#result').text(parseInt(totalSum / 1000) + ',' + parseInt(totalSum % 1000 / 100) + parseInt(totalSum % 100 / 10) + parseInt(totalSum % 10));
            else $('#result').text(totalSum);
            console.log($('#result').text())
            $("#pay").click(function () {

                window.location.href = `./確認画面.html?reservation=${reservation}&time=${time}&price=${totalSum}`;
            })
        }

    });
    var urlParams = new URLSearchParams(window.location.search);
    var reservation = urlParams.get('reservation');
    var time = urlParams.get('time');
</script>